```shell
#!/bin/bash
# c_axis_change_large

job_name="c_axis_change_large"
describe="Change the distance between atoms peperndicular to the Cu-O plane  of La2CuO4Sr with O1 vacancy static calculation, spuercell 2*2*1, no SOC,no DFT+U"
start_time=`date`
job_dir=`pwd`
hom1=`pwd`
echo "The home directory is ${hom1}."

######################################
#############  Preparation  #############
######################################
CPU_num=24
methods="PBE"
ENCUT_set=600
ISMEAR_tot_set=-5
KPOINTS_set="6   6   6"
NBANDS_set=192
#ISIF_set=2
#ISMEAR_line_set=0
#ISPIN_set=1
#LDAU_set=".FALSE."
#ISYM_set=2 # consider the symmetry during calculation

## KPOINTS_bulk
cat >KPOINTS<<!
Automatic mesh
0
Gamma
${KPOINTS_set}
0.0 0.0 0.0
!

## POSCAR_in_vac
cat >POSCAR_in_vac<<!
La2 Cu1 O4
1.0
        7.5799980164         0.0000000000         0.0000000000
       -0.0000040374         7.5799980164         0.0000000000
       -1.8950011753         1.8949983360         6.6049996256
   La   Cu    O   Sr
    7    4   15    1
Direct
     0.180999994         0.319000006         0.723999023
     0.180999994         0.819000006         0.723999023
     0.680999994         0.819000006         0.723999023
     0.319000006         0.180999994         0.275999993
     0.319000006         0.680999994         0.275999993
     0.819000006         0.180999994         0.275999993
     0.819000006         0.680999994         0.275999993
     0.000000000         0.000000000         0.000000000
     0.000000000         0.500000000         0.000000000
     0.500000000         0.000000000         0.000000000
     0.500000000         0.500000000         0.000000000
     0.090999998         0.409000009         0.363999993
     0.090999998         0.908999979         0.363999993
     0.591000021         0.409000009         0.363999993
     0.591000021         0.908999979         0.363999993
     0.409000009         0.090999998         0.635999978
     0.409000009         0.591000021         0.635999978
     0.908999979         0.090999998         0.635999978
     0.908999979         0.591000021         0.635999978
     0.250000000         0.000000000         0.000000000
     0.750000000         0.000000000         0.000000000
     0.750000000         0.500000000         0.000000000
     0.000000000         0.250000000         0.000000000
     0.000000000         0.750000000         0.000000000
     0.500000000         0.250000000         0.000000000
     0.500000000         0.750000000         0.000000000
     0.680999994         0.319000006         0.723999023
!
## POSCAR_out_vac
cat >POSCAR_out_vac<<!
La2 Cu1 O4
1.0
        7.5799980164         0.0000000000         0.0000000000
       -0.0000040374         7.5799980164         0.0000000000
       -1.8950011753         1.8949983360         6.6049996256
   La   Cu    O   Sr
    7    4   15    1
Direct
     0.180999994         0.319000006         0.723999023
     0.180999994         0.819000006         0.723999023
     0.680999994         0.819000006         0.723999023
     0.319000006         0.180999994         0.275999993
     0.319000006         0.680999994         0.275999993
     0.819000006         0.180999994         0.275999993
     0.819000006         0.680999994         0.275999993
     0.000000000         0.000000000         0.000000000
     0.000000000         0.500000000         0.000000000
     0.500000000         0.000000000         0.000000000
     0.500000000         0.500000000         0.000000000
     0.090999998         0.409000009         0.363999993
     0.090999998         0.908999979         0.363999993
     0.591000021         0.908999979         0.363999993
     0.409000009         0.090999998         0.635999978
     0.409000009         0.591000021         0.635999978
     0.908999979         0.090999998         0.635999978
     0.908999979         0.591000021         0.635999978
     0.250000000         0.000000000         0.000000000
     0.250000000         0.500000000         0.000000000
     0.750000000         0.000000000         0.000000000
     0.750000000         0.500000000         0.000000000
     0.000000000         0.250000000         0.000000000
     0.000000000         0.750000000         0.000000000
     0.500000000         0.250000000         0.000000000
     0.500000000         0.750000000         0.000000000
     0.680999994         0.319000006         0.723999023
!


# INCAR_stat
cat >INCAR<<!
# Comments
SYSTEM=La2CuO4_vac_stat
# I/O
ISTART = 0
ICHARG = 2
LWAVE = .FALSE.
#LCHARG = .FALSE.

# Bands
NBANDS = ${NBANDS_set}
NCORE = 4

# Electronic Relaxation
ENCUT = ${ENCUT_set}
NELM = 200
PREC = Accurate
ISMEAR = ${ISMEAR_tot_set}
EDIFF = 1E-7

# Electronic Relaxation
#ALGO = Fast
#LREAL = .FALSE. ! Default. More accurate in the reciprocal space than in the real space
# Ionic Relaxation
#IBRION = 2
#ISIF = 2
#EDIFFG = 1E-5
#NSW = 300
# POTIM = 0.5  # Default = 0.5
# Polarization
#ISPIN = 1 
#ISYM = 2  ! consider the symmetry
# Parallelization: multicore machines linked by a fast network
#LPLANE = .TRUE.
#LSCALU = .FALSE.
#NSIM = 4
!

#############################################
#########  VASP_static_calculation  #########
#############################################

for SYSTEM_name in "in_vac" "out_vac"
do
  mkdir ${SYSTEM_name}
  cd ${SYSTEM_name}
  for change in $(seq 0.8 0.05 1.2)
  do
    mkdir t_${change}
    cd t_${change}
    cp -pa ${hom1}/INCAR  ./
    cp -pa ${hom1}/POTCAR_${method} ./POTCAR
    cp -pa ${hom1}/KPOINTS ./
    awk -v change=${change} '{ if(NR==5) {$3=$3*change;printf ("%20.10f%21.10f%21.10f\n",$1,$2,$3)} else{print $0} }' ${hom1}/POSCAR_${SYSTEM_name}>POSCAR
    ## SUB_stat
    cat >SUB<<!
#BSUB -q e52680v3ib
#BSUB -n ${CPU_num}
#BSUB -J ${SYSTEM_name}_stat
#BSUB -o out
#BSUB -e err
module load ips/2019u5
mpirun vasp_std >log
!
    pwd
    date
    bsub  < SUB
    cd ..
  done
  cd ..
done

##############################
########### Record ###########
##############################
end_time=`date` 
cd ~
cat>>script_log<<!
======================================
Job name:      ${job_name}
Job directory: ${job_dir}
Description:   ${describe}
Start time:    ${start_time}
End time:      ${end_time}
If Checked (âœ“):
======================================
!

exit 0
```





```shell
#!/bin/bash
# c_axis_change_large

job_name="c_axis_change_large"
describe="Change the distance between atoms peperndicular to the Cu-O plane  of La2CuO4 with O1 vacancy static calculation, spuercell 2*2*1, no SOC,no DFT+U"
start_time=`date`
job_dir=`pwd`
hom1=`pwd`
echo "The home directory is ${hom1}."

######################################
#############  Preparation  #############
######################################
CPU_num=24
methods="PBE"
ENCUT_set=600
ISMEAR_tot_set=-5
KPOINTS_set="6   6   6"
NBANDS_set=192
#ISIF_set=2
#ISMEAR_line_set=0
#ISPIN_set=1
#LDAU_set=".FALSE."
#ISYM_set=2 # consider the symmetry during calculation

## KPOINTS_bulk
cat >KPOINTS<<!
Automatic mesh
0
Gamma
${KPOINTS_set}
0.0 0.0 0.0
!

## POSCAR_in_vac
cat >POSCAR_in_vac<<!
La2 Cu1 O4
1.0
        7.5799980164         0.0000000000         0.0000000000
       -0.0000040374         7.5799980164         0.0000000000
       -1.8950011753         1.8949983360         6.6049996256
   La   Cu    O
    8    4   15
Direct
     0.180999994         0.319000006         0.723999023
     0.180999994         0.819000006         0.723999023
     0.680999994         0.319000006         0.723999023
     0.680999994         0.819000006         0.723999023
     0.319000006         0.180999994         0.275999993
     0.319000006         0.680999994         0.275999993
     0.819000006         0.180999994         0.275999993
     0.819000006         0.680999994         0.275999993
     0.000000000         0.000000000         0.000000000
     0.000000000         0.500000000         0.000000000
     0.500000000         0.000000000         0.000000000
     0.500000000         0.500000000         0.000000000
     0.090999998         0.409000009         0.363999993
     0.090999998         0.908999979         0.363999993
     0.591000021         0.409000009         0.363999993
     0.591000021         0.908999979         0.363999993
     0.409000009         0.090999998         0.635999978
     0.409000009         0.591000021         0.635999978
     0.908999979         0.090999998         0.635999978
     0.908999979         0.591000021         0.635999978
     0.250000000         0.000000000         0.000000000
     0.750000000         0.000000000         0.000000000
     0.750000000         0.500000000         0.000000000
     0.000000000         0.250000000         0.000000000
     0.000000000         0.750000000         0.000000000
     0.500000000         0.250000000         0.000000000
     0.500000000         0.750000000         0.000000000
!
## POSCAR_out_vac
cat >POSCAR_out_vac<<!
La2 Cu1 O4
1.0
        7.5799980164         0.0000000000         0.0000000000
       -0.0000040374         7.5799980164         0.0000000000
       -1.8950011753         1.8949983360         6.6049996256
   La   Cu    O
    8    4   15
Direct
     0.180999994         0.319000006         0.723999023
     0.180999994         0.819000006         0.723999023
     0.680999994         0.319000006         0.723999023
     0.680999994         0.819000006         0.723999023
     0.319000006         0.180999994         0.275999993
     0.319000006         0.680999994         0.275999993
     0.819000006         0.180999994         0.275999993
     0.819000006         0.680999994         0.275999993
     0.000000000         0.000000000         0.000000000
     0.000000000         0.500000000         0.000000000
     0.500000000         0.000000000         0.000000000
     0.500000000         0.500000000         0.000000000
     0.090999998         0.409000009         0.363999993
     0.090999998         0.908999979         0.363999993
     0.591000021         0.908999979         0.363999993
     0.409000009         0.090999998         0.635999978
     0.409000009         0.591000021         0.635999978
     0.908999979         0.090999998         0.635999978
     0.908999979         0.591000021         0.635999978
     0.250000000         0.000000000         0.000000000
     0.250000000         0.500000000         0.000000000
     0.750000000         0.000000000         0.000000000
     0.750000000         0.500000000         0.000000000
     0.000000000         0.250000000         0.000000000
     0.000000000         0.750000000         0.000000000
     0.500000000         0.250000000         0.000000000
     0.500000000         0.750000000         0.000000000
!
elements=`sed -n '6,6p' POSCAR_out_vac`

## POTCAR
rm POTCAR*
for method in ${methods}
do
for ele in ${elements}
do
cat ~/POTCAR/${method}.54/${ele}/POTCAR >> ./POTCAR_${method}
done
## Find the maximum of the ENMAXs as ENCUT
grep 'ENMAX' POTCAR_${method}>temp
row=`awk 'END{print NR}' temp`
m=0
echo ${m}
for r in $( seq ${row} )
do
  t=`awk NR!=${r}'{next}{printf("%.3f",$3)}' temp`
  judge=`echo "${t}>${m}"|bc`
  if [ "${judge}" = "1" ];then
    m=${t}
  fi	
done
rm temp
m=`awk -v m=${m} 'BEGIN{m*=1.5;printf("%.3f",m)}'`
judge=`echo "${m}>${ENCUT_set}"|bc`
if [ "${judge}" = "1" ];then
  ENCUT_set=${m}
fi
done

# INCAR_stat
cat >INCAR<<!
# Comments
SYSTEM=La2CuO4_vac_stat
# I/O
ISTART = 0
ICHARG = 2
LWAVE = .FALSE.
#LCHARG = .FALSE.

# Bands
NBANDS = ${NBANDS_set}
NCORE = 4

# Electronic Relaxation
ENCUT = ${ENCUT_set}
NELM = 200
PREC = Accurate
ISMEAR = ${ISMEAR_tot_set}
EDIFF = 1E-7

# Electronic Relaxation
#ALGO = Fast
#LREAL = .FALSE. ! Default. More accurate in the reciprocal space than in the real space
# Ionic Relaxation
#IBRION = 2
#ISIF = 2
#EDIFFG = 1E-5
#NSW = 300
# POTIM = 0.5  # Default = 0.5
# Polarization
#ISPIN = 1 
#ISYM = 2  ! consider the symmetry
# Parallelization: multicore machines linked by a fast network
#LPLANE = .TRUE.
#LSCALU = .FALSE.
#NSIM = 4
!

#############################################
#########  VASP_static_calculation  #########
#############################################

for SYSTEM_name in "in_vac" "out_vac"
do
  mkdir ${SYSTEM_name}
  cd ${SYSTEM_name}
  for change in $(seq 0.8 0.05 1.2)
  do
    mkdir t_${change}
    cd t_${change}
    cp -pa ${hom1}/INCAR  ./
    cp -pa ${hom1}/POTCAR_${method} ./POTCAR
    cp -pa ${hom1}/KPOINTS ./
    awk -v change=${change} '{ if(NR==5) {$3=$3*change;printf ("%20.10f%21.10f%21.10f\n",$1,$2,$3)} else{print $0} }' ${hom1}/POSCAR_${SYSTEM_name}>POSCAR
    ## SUB_stat
    cat >SUB<<!
#BSUB -q e52680v3ib
#BSUB -n ${CPU_num}
#BSUB -J ${SYSTEM_name}_stat
#BSUB -o out
#BSUB -e err
module load ips/2019u5
mpirun vasp_std >log
!
    pwd
    date
    bsub  < SUB
    cd ..
  done
  cd ..
done

##############################
########### Record ###########
##############################
end_time=`date` 
cd ~
cat>>script_log<<!
======================================
Job name:      ${job_name}
Job directory: ${job_dir}
Description:   ${describe}
Start time:    ${start_time}
End time:      ${end_time}
If Checked (âœ“):
======================================
!

exit 0
```



```shell
#!/bin/bash
# collect
if [ -e "jieguo" ];then
  rm jieguo
fi
for change in $(seq 0.8 0.05 1.2)
  do
  unset shuju
  shuju=${change}
  for SYSTEM_name in "in_vac" "out_vac"
  do
     temp=`grep -i toten ${SYSTEM_name}/t_${change}/OUTCAR|tail -1|awk '{print $5}'`
     shuju=(${shuju[*]} ${temp}) 
     echo ${shuju[*]}
  done
   echo ${shuju[*]}>>jieguo
done

exit 0
```

```shell
#!/bin/bash
# reach
if [ -e "reach_result" ];then
  rm reach_result
fi
for change in $(seq 0.8 0.05 1.2)
  do
  for SYSTEM_name in "in_vac" "out_vac"
  do
     tail -2 ${SYSTEM_name}/t_${change}/log>>reach_result
  done
done

exit 0
```



```shell
c-axis  in_vac      out_vac
0.80 -177.68214816 -176.10749354
0.85 -187.81565495 -185.66881785
0.90 -193.63755490 -191.28376827
0.95 -196.50453130 -194.07874905
1.00 -197.30785163 -194.82660152
1.05 -196.68031763 -194.14275125
1.10 -195.08487199 -192.47080505
1.15 -192.85122243 -190.14732990
1.20 -190.21965354 -187.41697094
```

```shell
repSr
c-axis  in_vac      out_vac
0.80 -173.49198807 -172.98232606
0.85 -183.24234578 -182.27480885
0.90 -188.70334501 -187.59930826
0.95 -191.32895105 -190.15081161
1.00 -192.05531141 -190.72952275
1.05 -191.48869039 -189.93046489
1.10 -190.04116440 -188.21023232
1.15 -188.02133454 -185.88913230
1.20 -185.63425774 -183.19512401
```

```shell
La2 Cu1 O4                              
   1.00000000000000     
     7.5799980164000003    0.0000000000000000    0.0000000000000000
    -0.0000040374000000    7.5799980164000003    0.0000000000000000
    -1.8950011753000000    1.8949983360000000    6.6049996255999996
   La   Cu   O    Sr
     6     4    15     2
Direct
  0.1809999939999969  0.3190000060000031  0.7239990229999975
  0.6809999939999969  0.8190000060000031  0.7239990229999975
  0.3190000060000031  0.1809999939999969  0.2759999929999992
  0.3190000060000031  0.6809999939999969  0.2759999929999992
  0.8190000060000031  0.1809999939999969  0.2759999929999992
  0.8190000060000031  0.6809999939999969  0.2759999929999992
  0.0062682181351416 -0.0039787555718831  0.0069950907913662
 -0.0020641997631261  0.5030551555460051 -0.0238619981397378
  0.4967465616244858 -0.0006877625301267 -0.0103795431892737
  0.4930621756993177  0.4994048973086734 -0.0045953230965742
  0.1280756888705915  0.4049124113460515  0.3614134854191423
  0.0814103409384487  0.9037246393160739  0.3472679158525209
  0.5419750858938521  0.4259470020062961  0.3159096717375744
  0.6087148411731311  0.8625795239780644  0.3816217087060337
  0.4368510403839688  0.0670345166411461  0.6259702306981427
  0.4050473617225912  0.5743869269488933  0.6741034068175383
  0.9033176847700982  0.1123643376553254  0.6173284433783011
  0.9416686482711139  0.5637165066646577  0.6529702829654536
  0.2547070834381490 -0.0017844767939201  0.0058382810128552
  0.7530468623055743 -0.0079355003152507  0.0126343724962518
  0.7608378963778543  0.4945472624427864  0.0297076783727734
  0.0195470276824131  0.2504419386421485  0.0080489549442074
  0.0084915743405085  0.7438157827684503 -0.0020283497533111
  0.4859505436738943  0.2442437936774580  0.0085916685712263
  0.4955059295420934  0.7472981203946312  0.0040509515471709
  0.1809999939999969  0.8190000060000031  0.7239990229999975
  0.6809999939999969  0.3190000060000031  0.7239990229999975
 
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
  0.00000000E+00  0.00000000E+00  0.00000000E+00
```

